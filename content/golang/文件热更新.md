### golang实现文件的热更新


	https://segmentfault.com/a/1190000008487440
	http://dmdgeeker.com/post/golang-signal/
	http://colobu.com/2015/10/09/Linux-Signals/


### 信号说明

在POSIX.1-1990标准中定义的信号列表

	信号	值	动作	说明
	SIGHUP 	1 	Term 	终端控制进程结束(终端连接断开)
	SIGINT 	2 	Term 	用户发送INTR字符(Ctrl+C)触发
	SIGQUIT 	3 	Core 	用户发送QUIT字符(Ctrl+/)触发
	SIGILL 	4 	Core 	非法指令(程序错误、试图执行数据段、栈溢出等)
	SIGABRT 	6 	Core 	调用abort函数触发
	SIGFPE 	8 	Core 	算术运行错误(浮点运算错误、除数为零等)
	SIGKILL 	9 	Term 	无条件结束程序(不能被捕获、阻塞或忽略)
	SIGSEGV 	11 	Core 	无效内存引用(试图访问不属于自己的内存空间、对只读内存空间进行写操作)
	SIGPIPE 	13 	Term 	消息管道损坏(FIFO/Socket通信时，管道未打开而进行写操作)
	SIGALRM 	14 	Term 	时钟定时信号
	SIGTERM 	15 	Term 	结束程序(可以被捕获、阻塞或忽略)
	SIGUSR1 	30,10,16 	Term 	用户保留
	SIGUSR2 	31,12,17 	Term 	用户保留
	SIGCHLD 	20,17,18 	Ign 	子进程结束(由父进程接收)
	SIGCONT 	19,18,25 	Cont 	继续执行已经停止的进程(不能被阻塞)
	SIGSTOP 	17,19,23 	Stop 	停止进程(不能被捕获、阻塞或忽略)
	SIGTSTP 	18,20,24 	Stop 	停止进程(可以被捕获、阻塞或忽略)
	SIGTTIN 	21,21,26 	Stop 	后台程序从终端中读取数据时触发
	SIGTTOU 	22,22,27 	Stop 	后台程序向终端中写数据时触发



windows下支持的信号时有限的, 在signal.h中定义, 分别是

             SIGINT      Ctrl+C中断

             SIGILL       非法指令

             SIGFPE      浮点异常

             SIGSEGV   段错误, 非法指针访问

             SIGTERM   kill发出的软件终止

             SIGBREAK Ctrl+Break中断

             SIGABRT   调用abort导致


### 信号用途示例

我们可以利用信号，实现一些动态功能（如不重启刷新加载配置等）。 在使用Nginx时，可以使用nginx -s reload来进行配置文件重载，而不中断服务。 这里我们使用Go语言信号量来模拟一下这个功能。




### 发送信号 

	sudo kill -USR1 24036   # 24036是进程id

	cd D:\mnt\zouhuigang.github.io\content\golang
  

https://github.com/araddon/gou/pull/7
https://github.com/araddon/gou/pull/7/files



### 系统任务

vi /usr/lib/systemd/system/ZsurnameServer.service

	[Unit]
	Description=zouhuigang zsurname server
	Documentation=https://github.com/zouhuigang
	After=network.target
	
	[Service]
	Type=simple
	WorkingDirectory=/nfs_file/software/zsurname
	ExecStart=/nfs_file/software/zsurname/ZsurnameServer
	Restart=on-failure
	PrivateTmp=true
	
	[Install]
	WantedBy=multi-user.target



启动ZsurnameServer：

	systemctl daemon-reload
	systemctl enable ZsurnameServer
	systemctl start ZsurnameServer
	journalctl -u ZsurnameServer.service

更新配置

	sudo kill -USR1 进程id

